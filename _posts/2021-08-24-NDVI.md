---
layout: post
title: "Estimating Farm Health Using Satellite Imagery"
---

In the early Spring of this year, I read a heartbreaking, yet enlightening book called Ocean of Life, by Callum Roberts. This book explains in painful detail how humans are destroying the ocean, wreaking havoc on its ecosystem, and the disastrous effects the earth is feeling as consequences of man-made climate change. There was a chapter in this book that discussed how modern agriculture has damaged the oceans, with some of the key players being nutrient run off and unearthing carbon stored underground. It was right around this time as well that I happened to find an invitation to join an open-source community, part of a Google-backed startup named [*Climate Farmers*](https://www.climatefarmers.org), that was fighting climate change by enabling regenerative agriculture at scale, with a focus on small farms. The timing was uncanny. Riding a wave of urgency and enthusiasm to learn more about regenerative agriculture and how we as humans can use these practices to actually save the world, I joined my first welcome call and have been actively involved ever since. After a few months of working diligently to share my knowledge and learn from others, I was invited to join the internal team and have since been incorporated as full-fledged part of Climate Farmers. 
My official title (as far as titles really go) is Remote Sensing Data Scientist, and my role has been, well, researching and evaluating strategies which use remote sensing to evaluate a farm’s environmental impact – bringing value to both the farmer and to the earth. Remote sensing is the practice researching and gaining an understanding of an object or process without making direct physical contact. In the context of regenerative agriculture, and specifically in the context of Climate Farmers, we practice remote sensing by using imagery from open-source satellites (Sentinel-1, Sentinel-2, Landsat-8, etc.) to assess farm and environment health. My current task is to come up with a way to measure how healthy a farm is. Sounds simple enough, but what is the *best* way to do that? It turns out, there are many different approaches. I’m hoping to use this post as a platform to explain my current approaches to this problem. I’ll be using Google Earth Engine, a powerful tool for geospatial scripting and visualization, to demonstrate strategies.

#### How to measure farm health? How does one determine if a plant is healthy?
Fortunately, some people a lot smarter than me figured out that, when looking at the electromagnetic spectrum, chlorophyll (you *do* remember middle school science class, right?) is very good at absorbing visible light while also reflecting near-infrared light. Plants lacking chlorophyll, i.e., unhealthy plants, absorb more of the near-infrared light. This should make sense at an intuitive level - healthy plants with lots of chlorophyll are very green, something we naturally associate with plant health. With this in mind, researchers developed an agriculture index (some would argue *the* agricultural index) called the Normalized Difference Vegetation Index (NDVI) as an indicator for plant health. The equation for this index is shown below.

{% include image.html image="projects/proj-5/ndvi-formula.png" %}

This index has a range of between -1.0 and 1.0, with negative values indicating water, snow, and urban areas, values close to 0 indicating bare soil, stones, and unhealthy plants, and values closer to 1 indicating healthy vegetation. We can use the NDVI to assess plant health, and by extension, farm health. Here’s a visual representation of the NDVI. Dark green areas represent very green and healthy vegetation, while light green represents less healthy vegetation or bare soil. Some water is present here and is shown as light green/blue.

{% include image.html image="projects/proj-5/ndvi-ex.png" %}

But we can’t just take the NDVI of a field and be done with it. Farms and croplands don’t exist in a vacuum – their surrounding environment, their climate, and the crops being grown have a strong effect on how the field looks and its health in general. We need to look at the field in the proper context. And since we *are* talking about regenerative agriculture, we want to see if a field’s health improves as a consequence of regenerative practices.

#### Strategies to assess a field health and improvement in field health
A naive approach would be to look at a sequence of images, calculate the NDVI, and base an assessment based purely on the value. But farming often has cycles – NDVI naturally decreases when crops are harvested and right before crops are planted. So, one can’t really say look strictly at the NDVI to assess health. 

{% include image.html image="projects/proj-5/median-ndvi-buffer.png" %}

As you can see, it would be a little difficult and silly to just say anything conclusive about vegetation health by this plot. A better approach would be to compare the target field’s NDVI with the environment around it – accounting for urban areas and water, of course. In doing so, one can develop a sort of moving NDVI threshold – should the target NDVI fall too far below this threshold, field health can be considered poor. Should the target’s NDVI be much higher than the surrounding area, it can be considered as quite healthy. Anything else can be thought of as adequate. This approach has been developed and documented by another player in the regenerative agriculture movement – [Regen Network.](https://www.regen.network/) Following Regen Network’s approach, we can see how this comparison holds up using the Sentinel-2 satellite. Regen Network recommends considering a 10 km^2 buffer area around your target field, so we’ll use that. We’ll also mask any pixels that have an NDVI value typically associated with man-made structures and water. I’ve set the mask to remove any pixel that has an NDVI below 0.2. Finally, we need to think about cloud coverage. Clouds can seriously hinder measurements – but some clouds, such as wispy cirrus clouds, don’t impair the image so much that the NDVI falls below our masking threshold. Therefore, we’ll be using a custom dataset in Earth Engine that attempts to mask all clouds as well.

{% include image.html image="projects/proj-5/ndvi-buffer-comparison.png" %}

I’m cheating a little, because I happen to know that this farm uses regenerative agriculture practices, and as such, has a very green field for most of the year. Looking at the current year so far, we can see the field is generally *much* greener than the surrounding area. It’s probably safe to assume that most farms in the area use destructive modern agriculture practices such as tilling, so what we’re seeing here makes sense. By Regen Network’s standards, our target farm is doing a great job. But could there be an even better way? 
Croplands fluctuate quite a bit based on human activity, and as such, when compared to fields that are committed to regenerative agriculture, there will always be dips in NDVI – many more dips than the target field. Perhaps a better idea is to compare the target fields with areas that don’t change so often – areas that are also normally very green would be even better. This next approach takes the target field and compares it to *forests.* I’ve taken the same 10 km^2 buffer zone as in the previous example for this comparison, as well as the cloud masker. Then, I’ve put together a small training data set with which to train an Earth Engine classifier. Finally, instead of masking all pixels below a certain threshold, I’ve masked all pixels that do not belong to my “Forests” class. Unfortunately, the first useable image of the year contains heavy snowfall – so let’s just ignore that image. We won’t find anything useful there. Let’s take a look at the result.

{% include image.html image="projects/proj-5/ndvi-forests-comparison.png" %}

This also looks pretty good. The NDVI of the forested areas is a bit higher, as it should be. What’s very cool, is that the target field actually has a much higher NDVI than forests outside of the summer months. This looks like a promising indicator for vegetation health and could be a good input for an ecosystem health monitoring tool.
Finally, another interesting approach would be to compare fields that contain the same crops. Unfortunately, without access to *very* high resolution satellite imagery and without any ground truth data, this would be a very difficult, if not impossible, task. We’ll save this approach for another time.

I’m really looking forward to seeing how far we can take this project. Regenerative agriculture has so much potential for climate change reversal! If you’re interested in getting involved or collaborating with Climate Farmers, shoot me an email or visit the [climate farmers website.](https://www.climatefarmers.org) We’re always looking for motivated people! I hope you found this post interesting - if you have any questions or comments, maybe something to add that I didn’t think about, just drop me a line. 




